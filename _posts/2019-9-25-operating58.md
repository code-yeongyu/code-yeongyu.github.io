---
layout: post
title: operating system concepts - interrupts
date: 2019-9-25 8:20:50 +0900
categories: [operating_system]
---

인터럽트

개요
- "기기가 작업을 끝냈다" 혹은 "기기가 사용중이다" 와 같은 정보를 운영체제에게 전달하는 방식
- 시스템버스를 통해 CPU에게 시그널을 보냄
- 운영체제와 하드웨어가 상호작용하는 방법
- CPU는 인터럽트를 받으면 즉시 실행중이던것을 고정된 장소로 옮긴다(고정된 장소는 보통 서비스 루틴의 시작주소가 포함됨)
- 자주 호출되기에 인터럽트들은 빠르게 처리되어야함
- 인터럽트 서비스가 실행되고 완료 될 때, 원래 원래 실행중이던 연산을 재개한다. - (마치 인터럽트가 일어나지 않은것처럼)
	- 그렇기 때문에 인터럽트는 인터럽트 당한 내용의 상태를 저장해야함
- 인터럽트는 서비스 루틴으로 제어를 전달
	- 서비스 루틴은 특정 인터럽트의 핸들러를 호출함
	- 서비스 루틴은 테이블(interrupt vector)을 통해 간접적으로 호출됨
		- 포인터들의 테이블은 메모리의 낮은 주소에 저장됨
		- 테이블안에는 다양한 기기들을 위한 인터럽트 서비스 루틴의 주소가 있음
		- 각각 고유한 숫자값으로 정렬됨
- Windows, Unix 등의 운영체제에서 이러한 방식으로 인터럽트를 발송함

실행
- CPU에 interrupt-request line 이라는 회로가 있음
	- CPU가 매 명령을 실행할때마다 감지함
- CPU가 인터럽트를 받으면 인터럽트 번호를 읽고 그 번호를 인덱스로 삼아 인터럽트 벡터로 점프함
- 그리고선 해당 인덱스와 관련된 주소의 명령을 시작함

- 인터럽트 핸들러
	- 작업 중 바뀔 내용, 인터럽트 원인 판단, 필수적인 처리작업, 상태 복원, 그리고 return_from_interrupt 명령을 실행하여 인터럽트 실행전 CPU 상태로 되돌려 놓는다.

즉 워크플로우는 다음과 같은 방식으로 진행

device controller가 interrupt-request-line으로 인터럽트 신호를 발생시킴 -> CPU가 인터럽트를 감지 -> CPU는 그 인터럽트를 인터럽트 핸들러로 전달하고 -> 핸들러는 기기를 서비스(기기에게 작동을 할 수 있게함)함으로써 인터럽트를 해제한다.

그런데 현대의 운영체제에서는
1. 중요한 일을 처리중에 인터럽트를 받았다면 그 일을 처리 한 뒤 인터럽트를 처리하는 능력
2. 기기에 대한 적절한 핸들러를 전달 할 효과적인 방법
3. 중요 인터럽트와 그렇지 않은 인터럽트 - 상황에 맞게 적절히 대응하기 위해
가 추가적으로 필요하다.

현대식 컴퓨터에서는 이러한 기능들이 CPU와 인터럽트 제어기 하드웨어에 의해 제공된다.